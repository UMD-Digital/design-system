import { Tokens, Typography, Elements } from '@universityofmaryland/variables';
import { MarkupCreate, Performance, Styles } from 'utilities';

type TypeBannerPromoProps = {
  headline?: HTMLElement | null;
  text?: HTMLElement | null;
  actions?: HTMLElement | null;
  theme?: string | null;
  includeSeal?: boolean;
};

const { Colors, Spacing } = Tokens;
const { ConvertJSSObjectToStyles } = Styles;
const { Node } = MarkupCreate;
const { Debounce } = Performance;
const { SansMedium, SansExtraLarge } = Typography;
const { Text } = Elements;

const LOGO_SEAL = `<svg width="195" height="163" viewBox="0 0 195 163" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M228.9 85.9433C245.46 147.009 208.782 209.778 146.985 226.139C85.1883 242.501 21.6585 206.262 5.09899 145.197C-11.4605 84.1314 25.218 21.3647 87.0177 5.00266C148.817 -11.3594 212.341 24.878 228.9 85.9433Z" stroke="white" stroke-miterlimit="10"/><path d="M28.503 171.588C27.8978 170.659 27.5315 169.742 27.3974 168.836C27.2633 167.93 27.3502 167.028 27.6618 166.132L29.82 166.443C29.5544 167.208 29.4601 167.922 29.5305 168.583C29.6009 169.244 29.8511 169.908 30.2823 170.568C30.5641 171.002 30.8532 171.325 31.1519 171.533C31.4514 171.744 31.7364 171.856 32.0062 171.866C32.2759 171.876 32.528 171.81 32.7549 171.663C33.0365 171.486 33.2015 171.227 33.2501 170.887C33.3024 170.549 33.2173 170.076 33.0022 169.472L32.2001 167.291C31.7716 166.135 31.6405 165.194 31.8075 164.471C31.9737 163.744 32.4158 163.154 33.1309 162.701C33.8061 162.274 34.4975 162.079 35.2077 162.126C35.9171 162.17 36.6056 162.425 37.2673 162.893C37.929 163.361 38.5278 164.002 39.0579 164.816C39.5189 165.527 39.8598 166.236 40.0731 166.937C40.2864 167.639 40.3962 168.317 40.3958 168.972C40.3954 169.627 40.3005 170.235 40.1082 170.797L37.8746 170.509C38.0536 170.059 38.1576 169.577 38.1873 169.064C38.2192 168.547 38.1632 168.02 38.0236 167.473C37.8811 166.928 37.6514 166.409 37.3279 165.914C37.0523 165.491 36.7712 165.163 36.4824 164.933C36.1928 164.701 35.9089 164.57 35.629 164.534C35.35 164.502 35.0817 164.566 34.822 164.731C34.5514 164.902 34.3807 165.14 34.3056 165.44C34.2313 165.744 34.3 166.168 34.5104 166.721L35.3928 169.092C35.6376 169.782 35.7797 170.418 35.8263 170.992C35.8729 171.565 35.7821 172.085 35.5576 172.54C35.333 172.995 34.968 173.384 34.4595 173.708C33.8463 174.097 33.19 174.282 32.4869 174.262C31.7839 174.241 31.0892 174.009 30.3971 173.568C29.7079 173.126 29.0756 172.466 28.506 171.587L28.503 171.588Z" fill="white"/><path d="M19.3135 153.746L30.4372 148.761L31.5011 151.071L20.3774 156.056L19.3135 153.746ZM22.6205 160.928L33.7442 155.943L34.8081 158.253L23.6843 163.239L22.6205 160.928ZM24.3902 152.802L26.2599 151.964L29.59 159.197L27.7202 160.035L24.3902 152.802Z" fill="white"/><path d="M16.861 146.533L28.4941 142.795L29.2944 145.213L17.6613 148.952L16.861 146.533Z" fill="white"/><path d="M14.3045 136.799C14.1032 135.888 14.0829 135.077 14.2472 134.366C14.4108 133.653 14.7424 133.06 15.2347 132.584C15.73 132.108 16.3808 131.787 17.1913 131.614C17.999 131.442 18.7295 131.471 19.3801 131.702C20.0306 131.933 20.5815 132.34 21.0348 132.919C21.4852 133.499 21.8114 134.246 22.0127 135.157L22.5647 137.652L26.8017 136.749L27.3519 139.227L15.4059 141.769L14.3029 136.793L14.3045 136.799ZM20.1257 135.956C19.9608 135.213 19.6765 134.689 19.2765 134.386C18.8736 134.084 18.3658 133.996 17.751 134.127C17.1246 134.26 16.6934 134.545 16.4611 134.984C16.2288 135.422 16.1947 136.011 16.3595 136.754L16.8304 138.872L20.5958 138.071L20.1249 135.953L20.1257 135.956Z" fill="white"/><path d="M12.0311 111.002L19.4443 110.977C21.1109 110.972 22.3671 111.408 23.207 112.288C24.0498 113.166 24.4757 114.451 24.4903 116.14C24.505 117.829 24.0994 119.117 23.2727 120.002C22.446 120.887 21.2004 121.33 19.5309 121.336L12.1178 121.36L12.0953 118.825L19.3958 118.803C20.4217 118.798 21.179 118.58 21.669 118.142C22.1598 117.707 22.4024 117.042 22.3936 116.146C22.3857 115.254 22.1334 114.594 21.6368 114.166C21.1401 113.739 20.3788 113.528 19.3522 113.53L12.0517 113.553L12.0304 110.999L12.0311 111.002Z" fill="white"/><path d="M13.9171 95.5191L26.0232 97.3051L25.6059 100.174L17.8796 103.32L15.7482 104.062L15.747 104.081L17.8498 104.316L24.8567 105.349L24.529 107.602L12.4229 105.816L12.8354 102.964L20.5425 99.8167L22.6931 99.0762L22.699 99.0403L20.5963 98.805L13.5894 97.7719L13.9171 95.5191Z" fill="white"/><path d="M15.8188 88.1405L27.6603 91.2525L27.015 93.7024L15.1735 90.5904L15.8188 88.1405Z" fill="white"/><path d="M20.9239 73.5388L30.8164 81.9708L29.7703 84.7337L16.7519 84.5563L17.7014 82.0494L25.8943 82.4089L28.3985 82.6071L26.3995 81.1287L20.0054 75.9752L20.9297 73.5373L20.9239 73.5388Z" fill="white"/><path d="M33.4989 75.7582L22.7304 69.9612L27.0763 61.9787L28.8878 62.9545L25.7531 68.7106L28.4294 70.1508L30.8959 65.6179L32.6263 66.5495L30.1598 71.0825L32.9023 72.5582L36.1578 66.577L37.9693 67.5528L33.5027 75.7604L33.4989 75.7582Z" fill="white"/><path d="M32.8201 53.7153C33.6345 52.6125 34.5441 51.9397 35.5499 51.7C36.5557 51.4602 37.5114 51.6701 38.4207 52.3317C39.3891 53.0371 39.8985 53.8913 39.9462 54.8951C39.9946 55.9018 39.6174 56.9488 38.8103 58.0435L38.7778 58.3388L37.2303 60.4389L41.0191 63.1922L39.5354 65.2038L29.6469 58.0203L32.8201 53.7153ZM37.1713 57.2403C37.5931 56.6678 37.7901 56.1577 37.7635 55.7033C37.7377 55.2518 37.4772 54.8496 36.9871 54.4923C36.4977 54.1379 36.0335 54.0137 35.5893 54.1244C35.1481 54.2343 34.7166 54.5755 34.2947 55.1479L32.7787 57.2023L35.6545 59.2918L37.1705 57.2374L37.1713 57.2403ZM38.4885 56.3574L45.7521 56.7745L44.0626 59.0679L37.8022 58.5395L38.4893 56.3603L38.4885 56.3574Z" fill="white"/><path d="M41.6658 43.1536C42.4367 42.3648 43.2511 41.8045 44.109 41.4728C44.9669 41.141 45.8739 41.0239 46.8279 41.125L47.0254 43.2764C46.2109 43.1916 45.4877 43.2572 44.8558 43.4734C44.2209 43.6904 43.63 44.0796 43.0829 44.6412C42.722 45.0105 42.4756 45.3621 42.3378 45.6975C42.2001 46.0329 42.1588 46.3305 42.2118 46.5939C42.2648 46.8574 42.3893 47.0833 42.5851 47.2717C42.8238 47.5019 43.1189 47.605 43.4629 47.5768C43.8077 47.5515 44.2503 47.3664 44.7964 47.0201L46.7516 45.7607C47.7869 45.0893 48.6808 44.7512 49.431 44.7501C50.1813 44.749 50.8644 45.0429 51.4775 45.6327C52.0561 46.1879 52.4055 46.8127 52.5288 47.5064C52.6521 48.2001 52.5603 48.9224 52.2546 49.6667C51.9489 50.411 51.46 51.1287 50.7822 51.8213C50.1903 52.4258 49.5755 52.9118 48.9361 53.2733C48.2975 53.6377 47.6538 53.8912 47.0125 54.0382C46.3682 54.186 45.7483 54.2276 45.1536 54.1659L44.9158 51.9472C45.3973 52.0199 45.8949 52.0136 46.4086 51.9283C46.9223 51.8429 47.4314 51.6716 47.933 51.4149C48.4345 51.1582 48.8909 50.8168 49.3038 50.3965C49.6546 50.0362 49.9093 49.6918 50.0699 49.3597C50.2305 49.0276 50.2923 48.7246 50.2611 48.4492C50.23 48.1738 50.1029 47.9267 49.8815 47.7138C49.6511 47.4909 49.3787 47.3787 49.0635 47.3744C48.7483 47.3701 48.3465 47.5319 47.8544 47.8577L45.7308 49.2363C45.1081 49.6246 44.5195 49.9073 43.9662 50.0778C43.41 50.2491 42.8841 50.2785 42.3819 50.1644C41.8827 50.0496 41.4143 49.7833 40.9769 49.3655C40.4531 48.8613 40.119 48.2698 39.9738 47.5881C39.8287 46.9064 39.8947 46.1815 40.1699 45.4172C40.445 44.6529 40.9448 43.895 41.6717 43.152L41.6658 43.1536Z" fill="white"/><path d="M50.547 35.3181L58.4366 44.6068L56.4858 46.2322L48.5962 36.9436L50.547 35.3181Z" fill="white"/><path d="M62.468 26.8115L63.6287 28.5001L60.2492 30.773L65.992 39.1197L63.883 40.5378L58.1402 32.1911L54.7476 34.4736L53.5869 32.7851L62.4672 26.8086L62.468 26.8115Z" fill="white"/><path d="M74.759 20.4888L74.3538 29.1892L76.4237 33.2436L74.1426 34.3767L72.0728 30.3224L64.7483 25.4667L67.1751 24.2578L70.5843 26.6385L72.2737 27.917L72.2537 25.8065L72.3474 21.6844L74.7582 20.4859L74.759 20.4888Z" fill="white"/><path d="M89.544 15.3058C90.7083 14.9807 91.7803 14.9386 92.7614 15.1852C93.7455 15.4311 94.5941 15.9402 95.3115 16.705C96.0297 17.4728 96.5685 18.481 96.9309 19.7289C97.2933 20.9767 97.3774 22.114 97.1788 23.1355C96.9809 24.1599 96.5304 25.0296 95.8289 25.7503C95.1273 26.471 94.1921 26.9913 93.0316 27.3186C91.8672 27.6437 90.7924 27.6866 89.8054 27.4415C88.8154 27.1972 87.9647 26.6918 87.2465 25.924C86.5283 25.1562 85.9895 24.148 85.6271 22.9002C85.2647 21.6523 85.1805 20.5151 85.3792 19.4935C85.577 18.4691 86.0275 17.5994 86.7379 16.8765C87.4453 16.1542 88.3797 15.6309 89.544 15.3058ZM90.1236 17.3037C89.4587 17.4912 88.9406 17.8021 88.5662 18.2372C88.1919 18.6723 87.9685 19.2235 87.8983 19.8871C87.8282 20.5507 87.9183 21.3186 88.1717 22.1899C88.422 23.0497 88.7559 23.7441 89.1721 24.2797C89.5904 24.8116 90.0737 25.1675 90.6272 25.3428C91.1777 25.5189 91.7858 25.5147 92.4506 25.3273C93.1038 25.1429 93.6161 24.8336 93.9904 24.3985C94.3647 23.9634 94.5844 23.41 94.653 22.7406C94.7216 22.0712 94.6322 21.3062 94.382 20.4465C94.1285 19.5751 93.7931 18.8749 93.3763 18.3488C92.9596 17.8227 92.477 17.4697 91.9236 17.2943C91.3731 17.1182 90.7679 17.1217 90.1177 17.3053L90.1236 17.3037Z" fill="white"/><path d="M109.536 14.0697L102.992 14.8509L103.381 17.9114L108.544 17.2942L108.801 19.3175L103.638 19.9348L104.261 24.8563L101.725 25.1591L100.202 13.1296L109.282 12.0456L109.539 14.0689L109.536 14.0697Z" fill="white"/><path d="M129.805 12.541L129.663 14.5726L125.58 14.2699L124.878 24.3192L122.327 24.1305L123.03 14.0812L118.929 13.7772L119.071 11.7456L129.805 12.5381L129.805 12.541Z" fill="white"/><path d="M136.62 13.6866L134.038 25.5177L131.539 24.9691L134.122 13.1381L136.62 13.6866ZM142.133 19.987L141.699 21.9774L133.876 20.2619L134.31 18.2716L142.133 19.987ZM144.387 15.3919L141.805 27.2229L139.306 26.6744L141.889 14.8433L144.387 15.3919Z" fill="white"/><path d="M145.33 28.2859L149.579 16.9453L158.178 20.1486L157.464 22.0568L151.263 19.7464L150.207 22.5643L155.087 24.384L154.404 26.2064L149.523 24.3867L148.442 27.2736L154.889 29.6754L154.175 31.5836L145.334 28.291L145.33 28.2859Z" fill="white"/><path d="M172.76 27.5898C173.705 28.1765 174.433 28.8516 174.943 29.6151C175.453 30.3787 175.765 31.2348 175.869 32.18L173.786 32.8123C173.695 32.0071 173.472 31.3176 173.125 30.748C172.775 30.1793 172.266 29.6836 171.594 29.2683C171.152 28.995 170.754 28.8254 170.394 28.7612C170.034 28.6969 169.728 28.7151 169.48 28.8208C169.233 28.9264 169.037 29.0934 168.892 29.3218C168.717 29.6016 168.677 29.9051 168.776 30.2343C168.875 30.5635 169.155 30.9545 169.612 31.4108L171.275 33.0492C172.159 33.917 172.684 34.7139 172.848 35.4408C173.008 36.1684 172.866 36.8915 172.417 37.6052C171.994 38.2775 171.45 38.745 170.792 39.0054C170.131 39.2665 169.403 39.3243 168.604 39.1823C167.804 39.0374 166.989 38.7095 166.161 38.1949C165.436 37.7468 164.829 37.2488 164.331 36.7033C163.837 36.157 163.446 35.5896 163.161 34.9944C162.877 34.4021 162.703 33.8089 162.636 33.2187L164.774 32.5345C164.808 33.015 164.92 33.4966 165.114 33.9785C165.309 34.4604 165.587 34.9171 165.947 35.3492C166.31 35.7834 166.742 36.1562 167.245 36.4695C167.676 36.7364 168.07 36.9133 168.433 37.0016C168.793 37.0877 169.107 37.0891 169.376 37.0029C169.644 36.9166 169.857 36.7421 170.019 36.4843C170.188 36.2155 170.241 35.9272 170.18 35.6222C170.116 35.318 169.87 34.9588 169.444 34.5473L167.628 32.7716C167.112 32.2497 166.708 31.7357 166.419 31.2318C166.131 30.7278 165.99 30.2225 165.996 29.713C166.002 29.2064 166.164 28.6961 166.484 28.1879C166.87 27.5752 167.383 27.1315 168.024 26.8538C168.667 26.5754 169.395 26.4929 170.209 26.5996C171.025 26.7093 171.875 27.0403 172.767 27.5941L172.76 27.5898Z" fill="white"/><path d="M187.814 38.9405L186.512 40.5115L183.342 37.9292L176.906 45.7051L174.924 44.0914L181.359 36.3155L178.173 33.7217L179.475 32.1507L187.815 38.9434L187.814 38.9405Z" fill="white"/><path d="M188.192 56.6351L186.354 54.7339L187.797 51.9628L184.545 48.6003L181.689 49.9101L179.877 48.0362L191.787 42.8783L193.909 45.0727L188.196 56.6402L188.192 56.6351ZM186.303 47.7198L188.758 50.2599L191.369 45.3327L186.303 47.7198Z" fill="white"/><path d="M204.229 57.7132L202.586 58.9346L200.118 55.6801L191.995 61.7128L190.454 59.6799L198.577 53.6471L196.098 50.3795L197.742 49.161L204.229 57.7132Z" fill="white"/><path d="M131.544 64.7465H88.2661L131.544 114.52L88.2661 164.293H131.544L174.823 114.52L131.544 64.7465Z" fill="white"/></svg>`;

const SMALL = 480;

const ELEMENT_NAME = 'umd-element-banner-promo';
const ELEMENT_DECLARATION = 'banner-promo-declaration';
const ELEMENT_CONTAINER = 'banner-promo-container';
const ELEMENT_WRAPPER = 'banner-promo-wrapper';
const ELEMENT_TEXT_CONTAINER = 'banner-promo-text-container';
const ELEMENT_HEADLINE = 'banner-promo-headline';
const ELEMENT_RICH_TEXT = 'banner-promo-rich-text';
const ELEMENT_ACTIONS = 'banner-promo-actions';

const ATTRIBUTE_THEME = 'theme';
const THEME_DARK = 'dark';

// prettier-ignore
const OverwriteThemeDark = `

`;

// prettier-ignore
const ActionsStyles = `
@container ${ELEMENT_NAME} (max-width: ${SMALL - 1}px) {
  .${ELEMENT_ACTIONS} {
    margin-top: ${Spacing.sm};
  }
}
`;

// prettier-ignore
const TextStyles = `
  ${ConvertJSSObjectToStyles({
    styleObj: {
      [`.${ELEMENT_RICH_TEXT}`]: Text.RichText,
    },
  })}

  .${ELEMENT_RICH_TEXT} {
    margin-top: ${Spacing.min};
  }
`;

// prettier-ignore
const HeadlineStyles = `
  ${ConvertJSSObjectToStyles({
    styleObj: {
      [`.${ELEMENT_HEADLINE}`]: SansExtraLarge,
    },
  })}

  .${ELEMENT_HEADLINE} {
    text-transform: uppercase;
    color: ${Colors.black};
    font-weight: 800;
  }
`;

// prettier-ignore
const TextContainerStyles = `
  @container ${ELEMENT_NAME} (min-width: ${SMALL}px) {
    .${ELEMENT_TEXT_CONTAINER} {
      width: 70%;
    }
  }
`;

// prettier-ignore
const WrapperStyles = `
  .${ELEMENT_WRAPPER} {
    z-index: 9;
    position: relative;
  }

  @container ${ELEMENT_NAME} (min-width: ${SMALL}px) {
    .${ELEMENT_WRAPPER} {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
  }
`;

const STYLES_BANNER_PROMO_ELEMENT = `
  .${ELEMENT_DECLARATION} {
    container: ${ELEMENT_NAME} / inline-size;
  }

  .${ELEMENT_CONTAINER} {
    padding: ${Spacing.lg} ${Spacing.lg};
    background-color: ${Colors.gold};
    overflow: hidden;
  }

  @container ${ELEMENT_NAME} (min-width: ${SMALL}px) {
    .${ELEMENT_CONTAINER} {
      padding: ${Spacing.xl};
    }
  }

  .${ELEMENT_CONTAINER} > img {
    position: absolute;
    right: 0;
    bottom: 0;
    height: 100%;
    max-height: 110px;
    object-fit: cover;
  }

  ${WrapperStyles}
  ${TextContainerStyles}
  ${HeadlineStyles}
  ${TextStyles}
  ${ActionsStyles}
  ${OverwriteThemeDark}
`;

const CreateTextContainer = (props: TypeBannerPromoProps) => {
  const { headline, text } = props;
  const container = document.createElement('div');

  container.classList.add(ELEMENT_TEXT_CONTAINER);

  if (headline) {
    headline.classList.add(ELEMENT_HEADLINE);
    container.appendChild(headline);
  }

  if (text) {
    text.classList.add(ELEMENT_RICH_TEXT);
    container.appendChild(text);
  }

  return container;
};

const CreateBannerPromoElement = (props: TypeBannerPromoProps) =>
  (() => {
    const { theme, includeSeal = true, actions } = props;
    const declaration = document.createElement('div');
    const container = document.createElement('div');
    const wrapper = document.createElement('div');
    const textContainer = CreateTextContainer(props);

    wrapper.classList.add(ELEMENT_WRAPPER);
    wrapper.appendChild(textContainer);

    if (actions) {
      actions.classList.add(ELEMENT_ACTIONS);
      wrapper.appendChild(actions);
    }

    if (theme) container.setAttribute(ATTRIBUTE_THEME, theme);
    container.classList.add(ELEMENT_CONTAINER);
    container.appendChild(wrapper);

    if (includeSeal) {
      const image = Node.imageFromSvg({ SVG: LOGO_SEAL });
      container.appendChild(image);
    }

    declaration.classList.add(ELEMENT_DECLARATION);
    declaration.appendChild(container);

    return declaration;
  })();

export default {
  CreateElement: CreateBannerPromoElement,
  Styles: STYLES_BANNER_PROMO_ELEMENT,
};
